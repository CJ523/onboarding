{"triggers":[],"nodes":[{"uid":"0aaa4ec7-c371-4674-95a0-3232a0abc018","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"df26f93d-a373-4172-ab38-023bfad40fae","commandName":"connect","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"connectionMode","value":{"type":"STRING","string":"USER"}},{"name":"databaseProvider","value":{"type":"STRING","string":"SQLOLEDB.1"}},{"name":"server","value":{"type":"STRING","string":"CJ\\SQLEXPRESS"}},{"name":"database","value":{"type":"STRING","string":"Hr_Department"}},{"name":"user","value":{"type":"CREDENTIAL","expression":"$Username$"}},{"name":"auth","value":{"type":"CREDENTIAL","expression":"$Password$"}},{"name":"instance","value":{"type":"STRING","string":""}},{"name":"isUserDefinedDriver","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"9417cbf4-876a-4bfc-aedc-0af4a87498a4","commandName":"store","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"Delete_New_Joinings"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Connecting to Database"}}]},{"uid":"8444f2ef-5056-45cf-a4bc-3abfebef669c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b4fd56fd-e45c-4a40-86ef-d1387b88f161","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/ASUS_PC/Desktop/feat%20systems/AA/HR%20task/Input_Excel.xlsx"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"uid":"b70f4885-6aaf-4a69-867b-1f67eb71c3f4","commandName":"GetMultipleCells","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"V_InputExcelData"}},{"uid":"008d1131-c0da-417b-9295-c25f84252b26","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]},{"uid":"610b1166-ca6f-453a-bb25-3334b3fff0d2","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f006607e-a1c1-410d-bda2-b9c9e6ca2ed8","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"a880ef00-2645-4a26-9335-298cfd5142f7","commandName":"insertUpdateDelete","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","expression":"insert into New_Joinings_Details (Department_id,Name,Joining_Date)Values ('$V_Eachinput{\"Department_id\"}$','$V_Eachinput{\"Name_Of_Employee\"}$','$V_Eachinput{\"Joining_Date\"}$')"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"V_Eachinput"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"V_InputExcelData"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Inserting New Joining Data"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Entering new joining to Database"}}]},{"uid":"4f4ea0f9-f2c0-4050-b7e0-f5ab1fd36cc4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ef09292b-b6bc-4986-9eaf-d32d87183c5e","commandName":"exportToDataTable","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"select Department_Name from Department_Details;"}}],"returnTo":{"type":"VARIABLE","variableName":"v_DB_DepartmentList"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Exporting Department list from Database"}}]},{"uid":"8b8b4ae7-8c77-4804-9771-dc2cce1cf84f","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"cdf23e91-9dd6-4c83-8b80-6d113ab7a829","commandName":"store","packageName":"Database","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"query","value":{"type":"STRING","string":"LeftJoin"}},{"name":"doExport","value":{"type":"BOOLEAN","boolean":true}},{"name":"withHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/ASUS_PC/Desktop/feat%20systems/AA/HR%20task/Retrived%20Data.csv"}},{"name":"encodingType","value":{"type":"STRING","string":"UTF8"}},{"name":"appendTo","value":{"type":"STRING","string":"false"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Getting Department name for each New Joining"}}]},{"uid":"90d2eac7-26dc-4fee-ade9-4a6cb3ad58d3","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"44b87a99-1967-4177-b5c6-c14184b275af","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/ASUS_PC/Desktop/feat%20systems/AA/HR%20task/Master_Excel.xlsx"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}},{"name":"session","value":{"type":"STRING","string":"Default"}}]},{"uid":"3ed84afe-0f2f-4ab1-b216-0c898bae1505","commandName":"GetMultipleCells","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"loopSelection","value":{"type":"STRING","string":"ALL_ROWS"}},{"name":"readOption","value":{"type":"STRING","string":"READ_CELL_TEXT"}},{"name":"readOption_readCellText_Help","value":{"type":"STRING"}},{"name":"session","value":{"type":"SESSION","sessionName":{"type":"STRING","string":"Default"}}}],"returnTo":{"type":"VARIABLE","variableName":"v_Master"}},{"uid":"a5815fef-3899-48f6-ad34-e544d2e83f83","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"isSave","value":{"boolean":true,"type":"BOOLEAN"}},{"name":"session","value":{"sessionName":{"string":"Default","type":"STRING"},"type":"SESSION"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Getting Email and name of each Department Head"}}]},{"uid":"26f716d1-a7b3-42a3-a914-a7062f71fe19","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"37c252b5-5e68-483e-b717-8489c9c87f0f","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"12cc469c-2541-4b4c-834b-921cd13ee758","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"26852b47-c7a4-4e23-a5ca-70d3cf690cd6","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Users/ASUS_PC/Desktop/feat%20systems/AA/HR%20task/Retrived%20Data.csv"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"fcab6e84-4507-473e-ac64-5c7ef2d804bc","commandName":"ReadFromCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"returnTo":{"type":"VARIABLE","variableName":"V_joiningtable"}},{"uid":"98411fa0-feee-430e-9712-bdf90aff9512","commandName":"CloseCsvTxt","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"New Joining Details with their Department Name"}}]},{"uid":"21138232-9d21-4b9b-9172-14603a5a5294","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"15d74226-032e-4e3f-943d-242920478ece","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"V_eachmail"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Emptying Mail Body for each department"}}]},{"uid":"898eae76-3555-4e64-8362-e6aa554b3abb","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"858e004e-789c-49f1-abdc-54a2882b17d5","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"2513c174-3cd1-4221-be9f-a8436a179735","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"09c0c49e-7013-4d15-bdef-11af4007dc5d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"10a5b91c-130d-485e-a541-d6d934144848","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"a48f9599-f246-435e-ae5d-5e963162ffa6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$V_eachmail$<tr><td>$V_eachnewjoin{\"department_name\"}$</td><td>$V_eachnewjoin{\"name\"}$</td><td>$V_eachnewjoin{\"joining_date\"}$</td></tr>"}}],"returnTo":{"type":"VARIABLE","variableName":"V_eachmail"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Creating Mail Body"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$V_eachnewjoin{\"department_name\"}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$V_eachDep[0]$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Comparing Department Name"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"V_eachnewjoin"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"V_joiningtable"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Looping through each new Joining"}}]},{"uid":"d35d37e4-0e9c-4a80-ae51-916d7da21313","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f4bf2f8c-6fb6-4701-838b-9f8f812b6260","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"df1f53cc-5198-4e28-8597-d7bc310b6193","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"88626dba-0f03-4b8d-bd83-63bd08fc0d03","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"494ecad7-8e45-4fce-810a-5c353673a5bb","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"867f1c3b-5ade-409f-8dec-a1d0d9ff9b46","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$V_sendmail{\"E-Mail\"}$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"New Joining in Your Department"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"<body>\n\n<p>Hello Mr/Mrs.$V_sendmail{\"Department_Head\"}$\n<br>Kiendly Note there are new joining in your Dep\n<br>Plese refer to the table below</p>\n\n<table cellspacing=\"0\" border=\"1\">\n\t<tbody>\n\t\t<tr>\n\t\t\t<td>Department Name</td>\n\t\t\t<td>Name</td>\n\t\t\t<td>Joining Date</td>\n\t\t</tr>$V_eachmail$\n</tbody>\n</table>\n<p>Thank You</p>\n</body>\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"botrunner9@gmail.com"}},{"name":"emailServerHost","value":{"type":"STRING","string":"smtp.gmail.com"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"587"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":true}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":true}},{"name":"username","value":{"type":"CREDENTIAL","expression":"$emailid$"}},{"name":"securedPassword","value":{"type":"CREDENTIAL","expression":"$ePassword$"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Sending mail"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$V_sendmail{\"Department_Name\"}$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$V_eachDep[0]$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Comparing department name to send mail to department head"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"V_sendmail"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"v_Master"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Looping through each department head for sending mail"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"v_EachDep"},"attributes":[{"name":"sourceTable","value":{"type":"VARIABLE","variableName":"v_DB_DepartmentList"}}],"value":{"type":"ITERATOR","iteratorName":"iteratorTableRow","packageName":"DataTable"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Looping Through Each Department"}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"Username","description":"","type":"CREDENTIAL","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"sa"}},{"name":"Password","description":"","type":"CREDENTIAL","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"123456789"}},{"name":"v_DB_DepartmentList","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"v_Master","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"v_EachDep","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"V_joiningtable","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"V_eachnewjoin","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"V_eachmail","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"V_sendmail","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"emailid","description":"","type":"CREDENTIAL","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"botrunner9@gmail.com"}},{"name":"ePassword","description":"","type":"CREDENTIAL","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Feat#123"}},{"name":"V_InputExcelData","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"V_Eachinput","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}}],"breakpoints":[],"packages":[{"name":"CsvTxt","version":"2.4.0-20210504-152806"},{"name":"DataTable","version":"2.8.0-20210504-153459"},{"name":"Database","version":"3.1.1-20210526-115136"},{"name":"Email","version":"3.6.0-20210504-084515"},{"name":"Excel_MS","version":"5.7.0-20210419-191213"},{"name":"If","version":"3.0.0-20210504-152844"},{"name":"Loop","version":"3.0.0-20210504-152940"},{"name":"Step","version":"2.0.2-20210504-153452"},{"name":"String","version":"4.1.0-20210427-194725"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"improvedNumberSupport":true,"automationPriority":"PRIORITY_MEDIUM","botCodeVersion":"2"}}